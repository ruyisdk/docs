"use strict";(self.webpackChunkruyisdk=self.webpackChunkruyisdk||[]).push([[387],{79812:(e,n,a)=>{a.r(n),a.d(n,{assets:()=>o,contentTitle:()=>i,default:()=>u,frontMatter:()=>c,metadata:()=>t,toc:()=>l});var r=a(74848),s=a(28453);const c={sidebar_position:6},i="Using QEMU and LLVM",t={id:"Package-Manager/cases/case6",title:"Using QEMU and LLVM",description:"This case is based on Building Coremark for MilkV Duo",source:"@site/i18n/en/docusaurus-plugin-content-docs/current/Package-Manager/cases/case6.md",sourceDirName:"Package-Manager/cases",slug:"/Package-Manager/cases/case6",permalink:"/docs/en/docs/Package-Manager/cases/case6",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:6,frontMatter:{sidebar_position:6},sidebar:"tutorialSidebar",previous:{title:"Integration with CMake and Meson",permalink:"/docs/en/docs/Package-Manager/cases/case5"},next:{title:"Building the milkv-duo-examples Sample Program",permalink:"/docs/en/docs/Package-Manager/cases/case7"}},o={},l=[];function d(e){const n={a:"a",code:"code",h1:"h1",p:"p",pre:"pre",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h1,{id:"using-qemu-and-llvm",children:"Using QEMU and LLVM"}),"\n",(0,r.jsxs)(n.p,{children:["This case is based on ",(0,r.jsx)(n.a,{href:"/docs/en/docs/Package-Manager/cases/case2",children:"Building Coremark for MilkV Duo"})]}),"\n",(0,r.jsx)(n.p,{children:"First, install the necessary dependencies:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"ruyi install llvm-upstream gnu-plct qemu-user-riscv-upstream\n"})}),"\n",(0,r.jsx)(n.p,{children:"Create a virtual environment and activate it:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"ruyi venv -t llvm-upstream --sysroot-from gnu-plct -e qemu-user-riscv-upstream generic venv\n. venv/bin/ruyi-activate\n"})}),"\n",(0,r.jsx)(n.p,{children:"Unpack coremark and compile it:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"\xabRuyi milkv-venv\xbb $ mkdir coremark\n\xabRuyi milkv-venv\xbb $ cd coremark\n\xabRuyi milkv-venv\xbb $ ruyi extract coremark\n\n\xabRuyi milkv-venv\xbb $ sed -i 's/\\bgcc\\b/riscv64-unknown-linux-gnu-gcc/g' linux64/core_portme.mak\n\xabRuyi milkv-venv\xbb $ make PORT_DIR=linux64 link\n"})}),"\n",(0,r.jsx)(n.p,{children:"Now run coremark using qemu:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"$ ruyi-qemu coremark.exe\n2K performance run parameters for coremark.\nCoreMark Size    : 666\nTotal ticks      : 19567\nTotal time (secs): 19.567000\nIterations/Sec   : 10221.290949\nIterations       : 200000\nCompiler version : GCCClang 17.0.5\nCompiler flags   : -O2   -lrt\nMemory location  : Please put data memory location here\n                        (e.g. code in flash, data on heap etc)\nseedcrc          : 0xe9f5\n[0]crclist       : 0xe714\n[0]crcmatrix     : 0x1fd7\n[0]crcstate      : 0x8e3a\n[0]crcfinal      : 0x4983\nCorrect operation validated. See readme.txt for run and reporting rules.\nCoreMark 1.0 : 10221.290949 / GCCClang 17.0.5 -O2   -lrt / Heap\n"})})]})}function u(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},28453:(e,n,a)=>{a.d(n,{R:()=>i,x:()=>t});var r=a(96540);const s={},c=r.createContext(s);function i(e){const n=r.useContext(c);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:i(e.components),r.createElement(c.Provider,{value:n},e.children)}}}]);