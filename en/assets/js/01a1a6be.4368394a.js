"use strict";(self.webpackChunkruyisdk=self.webpackChunkruyisdk||[]).push([[5346],{54281:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>h,frontMatter:()=>i,metadata:()=>o,toc:()=>d});var a=t(74848),s=t(28453),r=t(84664);const i={sidebar_position:3},l="Managing Ruyi Packages",o={id:"Package-Manager/packages",title:"Managing Ruyi Packages",description:"Refreshing Local Package Cache",source:"@site/i18n/en/docusaurus-plugin-content-docs/current/Package-Manager/packages.mdx",sourceDirName:"Package-Manager",slug:"/Package-Manager/packages",permalink:"/docs/en/docs/Package-Manager/packages",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:3,frontMatter:{sidebar_position:3},sidebar:"tutorialSidebar",previous:{title:"Installation",permalink:"/docs/en/docs/Package-Manager/installation"},next:{title:"Using Integration Features",permalink:"/docs/en/docs/Package-Manager/intergration"}},c={},d=[{value:"Refreshing Local Package Cache",id:"refreshing-local-package-cache",level:2},{value:"<code>ruyi update</code> Pull Failure",id:"ruyi-update-pull-failure",level:3},{value:"Reading News",id:"reading-news",level:2},{value:"Listing Packages",id:"listing-packages",level:2},{value:"<code>latest</code>",id:"latest",level:3},{value:"<code>prerelease</code>",id:"prerelease",level:3},{value:"<code>latest-prerelease</code>",id:"latest-prerelease",level:3},{value:"<code>no binary for current host</code>",id:"no-binary-for-current-host",level:3},{value:"Installing Binary Packages",id:"installing-binary-packages",level:2},{value:"Installing Source Packages",id:"installing-source-packages",level:2},{value:"Uninstalling Packages",id:"uninstalling-packages",level:2}];function u(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",ul:"ul",...(0,s.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.h1,{id:"managing-ruyi-packages",children:"Managing Ruyi Packages"}),"\n",(0,a.jsx)(n.h2,{id:"refreshing-local-package-cache",children:"Refreshing Local Package Cache"}),"\n",(0,a.jsx)(n.p,{children:"Fetch the contents of remote package repositories and refresh the local package cache. By default, the mirror hosted on GitHub is used:"}),"\n",(0,a.jsx)(r.Ay,{lang:"bash",showTitleCopyButton:"true",code:"\n$ ruyi update\n"}),"\n",(0,a.jsxs)(n.p,{children:["The package cache will be stored in the user's home directory, typically at ",(0,a.jsx)(n.code,{children:"~/.cache/ruyi/packages-index/"}),". If the ",(0,a.jsx)(n.code,{children:"XDG_CACHE_HOME"})," environment variable is set, the directory will be ",(0,a.jsx)(n.code,{children:"$XDG_CACHE_HOME/ruyi/packages-index/"}),"."]}),"\n",(0,a.jsxs)(n.h3,{id:"ruyi-update-pull-failure",children:[(0,a.jsx)(n.code,{children:"ruyi update"})," Pull Failure"]}),"\n",(0,a.jsxs)(n.p,{children:["Since the package index is currently hosted in a GitHub repository, if the repository access becomes unstable, you can use the ",(0,a.jsx)(n.code,{children:"ruyi config"})," subcommand to configure the use of the ",(0,a.jsx)(n.a,{href:"https://mirror.iscas.ac.cn/git/ruyisdk/packages-index.git",children:"alternative repository"}),"."]}),"\n",(0,a.jsx)(r.Ay,{lang:"bash",showTitleCopyButton:"true",code:"\n# Check the current repository configuration\n$ ruyi config get repo.remote\n\n# Switch the remote repository to the ISCAS mirror\n$ ruyi config set repo.remote https://mirror.iscas.ac.cn/git/ruyisdk/packages-index.git\n\n# (Optional) Modify the default branch, usually set to main\n$ ruyi config set repo.branch main\n\n# (Optional) Modify the local cache directory\n$ ruyi config set repo.local /your/custom/cache/path\n\n# After completing the configuration changes, refresh the local package cache again\n$ ruyi update\n"}),"\n",(0,a.jsx)(n.h2,{id:"reading-news",children:"Reading News"}),"\n",(0,a.jsxs)(n.p,{children:["When you ran ",(0,a.jsx)(n.code,{children:"ruyi update"})," in the previous section to refresh the local package repository, you likely noticed that the Ruyi package manager listed unread news items. This is where you can stay informed about updates to Ruyi packages or other important notifications."]}),"\n",(0,a.jsxs)(n.p,{children:["Running ",(0,a.jsx)(n.code,{children:"ruyi news list"})," will also bring up this page, but it will display all news items, with unread ones highlighted in green on supported terminals."]}),"\n",(0,a.jsx)(n.p,{children:"You can use the following commands to browse, read news, and mark them as read:"}),"\n",(0,a.jsx)(r.Ay,{lang:"bash",showTitleCopyButton:"true",code:"\n$ ruyi news list -h\n$ ruyi news list\n$ ruyi news list --new        # List only unread news\n\n$ ruyi news read -h\n$ ruyi news read 1            # Read news with ID 1\n$ ruyi news read              # Read all unread news\n$ ruyi news read --quiet      # Output nothing, only mark unread news as read\n"}),"\n",(0,a.jsxs)(n.p,{children:["Ruyi marks news as read by storing the news titles in ",(0,a.jsx)(n.code,{children:"~/.local/state/ruyi/news.read.txt"}),", or at ",(0,a.jsx)(n.code,{children:"$XDG_STATE_HOME/ruyi/news.read.txt"})," if ",(0,a.jsx)(n.code,{children:"XDG_STATE_HOME"})," is configured."]}),"\n",(0,a.jsx)(n.h2,{id:"listing-packages",children:"Listing Packages"}),"\n",(0,a.jsx)(n.p,{children:"Ruyi packages are broadly categorized into several sections:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"toolchain: Toolchains"}),"\n",(0,a.jsx)(n.li,{children:"source: Source packages"}),"\n",(0,a.jsx)(n.li,{children:"emulator: Emulators"}),"\n",(0,a.jsx)(n.li,{children:"board-image: System images"}),"\n",(0,a.jsx)(n.li,{children:"analyzer: Analysis tools"}),"\n",(0,a.jsx)(n.li,{children:"extra: Miscellaneous"}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:"Package version numbers strictly follow the Semver specification, which may result in some differences from upstream versions."}),"\n",(0,a.jsx)(n.p,{children:"Packages are divided into officially released packages and prerelease packages. Prerelease packages are released earlier than their upstream counterparts but include bug fixes for the latest released version."}),"\n",(0,a.jsx)(n.p,{children:"Some older Ruyi packages also use slugs to mark versions, a deprecated feature that will be removed in the future."}),"\n",(0,a.jsxs)(n.p,{children:["Use the ",(0,a.jsx)(n.code,{children:"ruyi list"})," command to list all available packages. Note that even if a package/version is not supported on the current system architecture, it will still be listed."]}),"\n",(0,a.jsxs)(n.p,{children:["Here is an example on an ",(0,a.jsx)(n.code,{children:"x86_64"})," machine; the actual list will be longer:"]}),"\n",(0,a.jsx)(r.Ay,{lang:"bash",showTitleCopyButton:"true",code:"\n$ ruyi list --name-contains ''\nList of available packages:\n\n* source/milkv-duo-examples\n  - 0.20240719.0+git.52ae647a (latest)\n* source/ruyisdk-demo\n  - 0.20231114.0 (latest)\n* source/coremark\n  - 1.0.2-pre.20230125 (prerelease, latest-prerelease)\n  - 1.0.1 (latest)\n* toolchain/llvm-plct\n  - 17.0.6-ruyi.20240511 (latest)\n* toolchain/llvm-upstream\n  - 17.0.5-ruyi.20231121 (latest) slug: llvm-upstream-20231121\n* toolchain/gnu-milkv-milkv-duo-elf-bin\n  - 0.20240731.0+git.67688c7335e7 (latest)\n* analyzer/dynamorio-riscv\n  - 10.93.19979-ruyi.20240914 (latest, no binary for current host)\n  - 10.0.19748-ruyi.20240128 (no binary for current host)\n* board-image/uboot-revyos-sipeed-lc4a-8g\n  - 0.20240127.0 (latest)\n* board-image/uboot-oerv-sipeed-lpi4a-8g\n  - 0.2309.1 (latest)\n* board-image/canmv-linux-sdk-demo-canaan-k230d-rv64ilp32\n  - 0.20240731.0 (latest)\n  - 0.20240717.0 ()\n* emulator/qemu-user-riscv-xthead\n  - 6.1.0-ruyi.20231207+g03813c9fe8 (latest)\n* emulator/box64-upstream\n  - 0.3.1-pre.ruyi.20240901+git.9178effd (prerelease, latest-prerelease, no binary for current host)\n  - 0.3.0-ruyi.20240718 (latest, no binary for current host)\n  - 0.2.9-pre.ruyi.20240702+git.4b0b3fc9 (prerelease, no binary for current host)\n  - 0.2.8-ruyi.20240702 (no binary for current host)\n* emulator/qemu-user-riscv-upstream\n  - 8.2.0-ruyi.20240128 (latest)\n  - 8.1.2-ruyi.20231121 ()\n* extra/wps-office\n  - 12.1.0-r.17900 (latest)\n  - 12.1.0-r.17885 ()\n"}),"\n",(0,a.jsxs)(n.p,{children:["The ",(0,a.jsx)(n.code,{children:"list"})," command also provides the ",(0,a.jsx)(n.code,{children:"--verbose"})," or ",(0,a.jsx)(n.code,{children:"-v"})," option to output more detailed information, which will print almost all information from the package repository. Since the full output will be very long, it is recommended to pass a non-empty search field to ",(0,a.jsx)(n.code,{children:"--name-contains"}),", add other limiting parameters, or redirect the full output to a file or a tool such as ",(0,a.jsx)(n.code,{children:"less"}),"."]}),"\n",(0,a.jsxs)(n.p,{children:["Lines like ",(0,a.jsx)(n.code,{children:"toolchain/llvm-plct"})," represent a package name, which is required when using the ",(0,a.jsx)(n.code,{children:"install"})," command to install the package. In most cases, specifying only the name after the ",(0,a.jsx)(n.code,{children:"/"})," is sufficient, such as ",(0,a.jsx)(n.code,{children:"llvm-plct"})," in this example."]}),"\n",(0,a.jsx)(n.p,{children:"Following the package name is a list of version numbers. Version numbers can be used to specify a particular version of a package or versions that match a given expression. The content in parentheses after the version number marks some information about that version."}),"\n",(0,a.jsx)(n.h3,{id:"latest",children:(0,a.jsx)(n.code,{children:"latest"})}),"\n",(0,a.jsxs)(n.p,{children:["Marks the latest version of a package, which is the version that the ",(0,a.jsx)(n.code,{children:"install"})," command will install by default."]}),"\n",(0,a.jsx)(n.h3,{id:"prerelease",children:(0,a.jsx)(n.code,{children:"prerelease"})}),"\n",(0,a.jsx)(n.p,{children:"A prerelease version. This means the package was released earlier than its upstream counterpart, often including bug fixes for the latest released version, especially when a prerelease version is deemed necessary."}),"\n",(0,a.jsx)(n.p,{children:"By default, the Ruyi package manager ignores prerelease versions. You can configure the Ruyi package manager to install prerelease versions, but you assume the associated risks."}),"\n",(0,a.jsx)(n.h3,{id:"latest-prerelease",children:(0,a.jsx)(n.code,{children:"latest-prerelease"})}),"\n",(0,a.jsxs)(n.p,{children:["The latest prerelease version. When prerelease versions are allowed and this version is newer than the ",(0,a.jsx)(n.code,{children:"latest"})," version, it will be the version installed by default by the ",(0,a.jsx)(n.code,{children:"install"})," command."]}),"\n",(0,a.jsx)(n.p,{children:"If you need to install a prerelease version, you can add the following configuration to the configuration file:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"[packages]\nprereleases = true\n"})}),"\n",(0,a.jsx)(n.h3,{id:"no-binary-for-current-host",children:(0,a.jsx)(n.code,{children:"no binary for current host"})}),"\n",(0,a.jsx)(n.p,{children:"Indicates that the package version does not provide a binary package for the current host architecture."}),"\n",(0,a.jsx)(n.p,{children:"In some scenarios, it is appropriate to install packages for non-native architectures, such as using box64 to run WPS Office on a riscv64 machine."}),"\n",(0,a.jsx)(n.p,{children:"In such cases, you can specify the installation of a binary package for a particular architecture:"}),"\n",(0,a.jsx)(r.Ay,{lang:"bash",showTitleCopyButton:"true",code:"\n$ ruyi install --host x86_64 wps-office\n"}),"\n",(0,a.jsx)(n.h2,{id:"installing-binary-packages",children:"Installing Binary Packages"}),"\n",(0,a.jsx)(n.p,{children:"Typically, the following sections contain binary packages:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"toolchain: Toolchains"}),"\n",(0,a.jsx)(n.li,{children:"emulator: Emulators"}),"\n",(0,a.jsx)(n.li,{children:"board-image: System images"}),"\n",(0,a.jsx)(n.li,{children:"analyzer: Analysis tools"}),"\n",(0,a.jsx)(n.li,{children:"extra: Miscellaneous"}),"\n"]}),"\n",(0,a.jsxs)(n.p,{children:["These packages can be installed using the ",(0,a.jsx)(n.code,{children:"install"})," command, such as installing the GNU upstream GCC toolchain:"]}),"\n",(0,a.jsx)(r.Ay,{lang:"bash",showTitleCopyButton:"true",code:"\n$ ruyi install gnu-upstream\n$ ruyi install toolchain/gnu-upstream\n"}),"\n",(0,a.jsxs)(n.p,{children:["The above method of specifying the package name will by default install the version marked as ",(0,a.jsx)(n.code,{children:"latest"}),". If you want to install a specific historical version of gnu-upstream, you can specify the version:"]}),"\n",(0,a.jsx)(r.Ay,{lang:"bash",showTitleCopyButton:"true",code:"\n$ ruyi install 'gnu-upstream(0.20231118.0)'\n$ ruyi install 'gnu-upstream(>=0.20231118.0)'\n"}),"\n",(0,a.jsxs)(n.p,{children:["The expression supports ",(0,a.jsx)(n.code,{children:"<"}),", ",(0,a.jsx)(n.code,{children:">"}),", ",(0,a.jsx)(n.code,{children:"=="}),", ",(0,a.jsx)(n.code,{children:"<="}),", ",(0,a.jsx)(n.code,{children:">="}),", and ",(0,a.jsx)(n.code,{children:"!="})," operators."]}),"\n",(0,a.jsx)(n.p,{children:"If you want to install multiple packages:"}),"\n",(0,a.jsx)(r.Ay,{lang:"bash",showTitleCopyButton:"true",code:"\n$ ruyi install gnu-plct gnu-upsteam llvm-plct llvm-upstream\n"}),"\n",(0,a.jsx)(n.p,{children:"In some special cases, such as accidentally deleting files of an installed package, you can reinstall the package to restore it:"}),"\n",(0,a.jsx)(r.Ay,{lang:"bash",showTitleCopyButton:"true",code:"\n$ ruyi install --reinstall gnu-upstream\n"}),"\n",(0,a.jsxs)(n.p,{children:["Packages downloaded by the package manager are stored in ",(0,a.jsx)(n.code,{children:"~/.cache/ruyi/distfiles/"}),", or at ",(0,a.jsx)(n.code,{children:"$XDG_CACHE_HOME/ruyi/distfiles/"})," if ",(0,a.jsx)(n.code,{children:"XDG_CACHE_HOME"})," is specified. These packages are typically stored in a compressed format and require system tools to unpack. If the corresponding tools are missing on the system, a warning will be printed."]}),"\n",(0,a.jsxs)(n.p,{children:["By default, the ",(0,a.jsx)(n.code,{children:"install"})," command will only install binary packages for the current system architecture. Unpacked binary packages are stored in ",(0,a.jsx)(n.code,{children:"~/.local/share/ruyi/binaries/$(uname -m)/"}),", or at ",(0,a.jsx)(n.code,{children:"$XDG_DATA_HOME/ruyi/binaries/$(uname -m)/"})," if ",(0,a.jsx)(n.code,{children:"XDG_DATA_HOME"})," is specified."]}),"\n",(0,a.jsxs)(n.p,{children:["Since system images are also binary files, they can be downloaded and unpacked using the ",(0,a.jsx)(n.code,{children:"install"})," command. However, these packages are typically used in conjunction with Ruyi's image flashing functionality. Unpacked image files are stored in ",(0,a.jsx)(n.code,{children:"~/.local/share/ruyi/blobs/"}),", or at ",(0,a.jsx)(n.code,{children:"$XDG_DATA_HOME/ruyi/blobs/"})," if ",(0,a.jsx)(n.code,{children:"XDG_DATA_HOME"})," is specified."]}),"\n",(0,a.jsx)(n.h2,{id:"installing-source-packages",children:"Installing Source Packages"}),"\n",(0,a.jsx)(n.p,{children:"The following section clearly contains source packages:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"source: Source packages"}),"\n"]}),"\n",(0,a.jsxs)(n.p,{children:["Source packages can be downloaded and unpacked into the current directory using the ",(0,a.jsx)(n.code,{children:"extract"})," command:"]}),"\n",(0,a.jsx)(r.Ay,{lang:"bash",showTitleCopyButton:"true",code:"\n$ ruyi extract ruyisdk-demo\n$ ls\nREADME.md  rvv-autovec\n"}),"\n",(0,a.jsxs)(n.p,{children:["The ",(0,a.jsx)(n.code,{children:"extract"})," command supports the same version expression syntax as ",(0,a.jsx)(n.code,{children:"install"}),"."]}),"\n",(0,a.jsx)(n.h2,{id:"uninstalling-packages",children:"Uninstalling Packages"}),"\n",(0,a.jsx)(n.p,{children:"The Ruyi package manager does not implement the functionality to uninstall specific Ruyi packages. However, you can use the following command to delete all downloaded and installed packages:"}),"\n",(0,a.jsx)(r.Ay,{lang:"bash",showTitleCopyButton:"true",code:"\n$ ruyi self clean --distfiles --installed-pkgs\n"}),"\n",(0,a.jsxs)(n.p,{children:["If you insist on deleting a specific package, although it is not recommended, you can manually delete them. If you accidentally delete some files but Ruyi still considers the package installed, you can try using ",(0,a.jsx)(n.code,{children:"install --reinstall"})," to restore it."]}),"\n",(0,a.jsx)(n.p,{children:"Note that if a toolchain package is deleted, any virtual environments that depend on it will become invalid, and there will be no warning when activating such a compilation environment."})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(u,{...e})}):u(e)}},84664:(e,n,t)=>{t.d(n,{Ay:()=>p});var a=t(96540),s=t(26348),r=t(74848);const i=()=>(0,r.jsx)("svg",{height:"16",strokeLinejoin:"round",viewBox:"0 0 16 16",width:"16",style:{color:"currentcolor"},children:(0,r.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M2.75 0.5C1.7835 0.5 1 1.2835 1 2.25V9.75C1 10.7165 1.7835 11.5 2.75 11.5H3.75H4.5V10H3.75H2.75C2.61193 10 2.5 9.88807 2.5 9.75V2.25C2.5 2.11193 2.61193 2 2.75 2H8.25C8.38807 2 8.5 2.11193 8.5 2.25V3H10V2.25C10 1.2835 9.2165 0.5 8.25 0.5H2.75ZM7.75 4.5C6.7835 4.5 6 5.2835 6 6.25V13.75C6 14.7165 6.7835 15.5 7.75 15.5H13.25C14.2165 15.5 15 14.7165 15 13.75V6.25C15 5.2835 14.2165 4.5 13.25 4.5H7.75ZM7.5 6.25C7.5 6.11193 7.61193 6 7.75 6H13.25C13.3881 6 13.5 6.11193 13.5 6.25V13.75C13.5 13.8881 13.3881 14 13.25 14H7.75C7.61193 14 7.5 13.8881 7.5 13.75V6.25Z",fill:"currentColor"})}),l=()=>(0,r.jsx)("svg",{height:"16",strokeLinejoin:"round",viewBox:"0 0 16 16",width:"16",style:{color:"currentcolor"},children:(0,r.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M15.5607 3.99999L15.0303 4.53032L6.23744 13.3232C5.55403 14.0066 4.44599 14.0066 3.76257 13.3232L4.2929 12.7929L3.76257 13.3232L0.969676 10.5303L0.439346 9.99999L1.50001 8.93933L2.03034 9.46966L4.82323 12.2626C4.92086 12.3602 5.07915 12.3602 5.17678 12.2626L13.9697 3.46966L14.5 2.93933L15.5607 3.99999Z",fill:"currentColor"})}),o=()=>(0,r.jsx)("span",{className:"text-[13px] font-mono text-neutral-600 dark:text-neutral-400",children:">_"}),c=e=>{let{textToCopy:n}=e;const[t,s]=(0,a.useState)(!1);return(0,r.jsx)("button",{onClick:async()=>{if(n)try{await navigator.clipboard.writeText(n),s(!0),setTimeout((()=>s(!1)),2e3)}catch(e){console.error("Copy failed:",e)}},className:"flex items-center justify-center p-2 rounded-md border-0 cursor-pointer  transition-all duration-200  text-neutral-500 hover:text-neutral-900 hover:bg-neutral-200  dark:text-neutral-400 dark:hover:text-white dark:hover:bg-neutral-700  focus-visible:outline-2 focus-visible:outline-blue-500 focus-visible:outline-offset-2","aria-label":"Copy code",title:t?"Copied!":"Copy code",children:t?(0,r.jsx)("span",{className:"text-green-500 dark:text-green-400",children:(0,r.jsx)(l,{})}):(0,r.jsx)(i,{})})},d=e=>{let{langs:n,currentLang:t,onLangChange:a}=e;return n&&0!==n.length?(0,r.jsx)("div",{className:"flex items-center gap-1",children:n.map(((e,n)=>{const s=e.lang===t;return(0,r.jsx)("button",{onClick:()=>a(e.lang),className:`\n                            px-2 py-1 text-xs font-medium rounded transition-all duration-200\n                            ${s?"bg-neutral-200 text-neutral-900 dark:bg-neutral-700 dark:text-neutral-100":"text-neutral-600 hover:text-neutral-900 hover:bg-neutral-100 dark:text-neutral-400 dark:hover:text-neutral-100 dark:hover:bg-neutral-800"}\n                        `,"aria-label":`Switch to ${e.lang}`,children:e.lang},e.lang||n)}))}):null},u=e=>{let{title:n,code:t,isHovered:a,copiable:s=!0,langs:i=[],currentLang:l,onLangChange:u}=e;return(0,r.jsxs)("div",{className:"flex items-center justify-between pl-4 pr-3 py-0 min-h-[48px] bg-neutral-50 dark:bg-neutral-800",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:["Terminal"===n&&(0,r.jsx)(o,{}),(0,r.jsx)("span",{className:"text-[13px] font-normal tracking-normal  text-neutral-600 dark:text-neutral-400 font-sans",children:n})]}),(0,r.jsx)(d,{langs:i,currentLang:l,onLangChange:u})]}),s&&(0,r.jsx)("div",{className:"transition-opacity duration-200",style:{opacity:a?1:0},children:(0,r.jsx)(c,{textToCopy:t})})]})};function h(e){if("string"!=typeof e)return"";const n=e.replace(/\r\n/g,"\n").split("\n");return n.length>0&&""===n[0].trim()&&n.shift(),n.join("\n")}const p=e=>{let{code:n="",lang:t="bash",langs:i=[],filename:l="",title:o="",copiable:c=!1,input:d=""}=e;const[p,g]=(0,a.useState)(!1),[y,m]=(0,a.useState)(t),x=(0,a.useMemo)((()=>{if(!d)return new Set;const e=new Set;return d.split(",").forEach((n=>{if((n=n.trim()).includes("-")){const[t,a]=n.split("-").map((e=>parseInt(e.trim(),10)));for(let n=t;n<=a;n++)e.add(n-1)}else{const t=parseInt(n,10);isNaN(t)||e.add(t-1)}})),e}),[d]),f=(0,a.useMemo)((()=>{if(i&&i.length>0){const e=i.find((e=>e.lang===y));return e?e.code:n}return n}),[i,y,n]),{displayCode:b,highlightLines:k}=(0,a.useMemo)((()=>{const e=f.split("\n"),n=new Set;let t=!1;const a=[];return e.forEach((e=>{const s=e.trim();s.includes("highlight-start")?t=!0:s.includes("highlight-end")?t=!1:s.includes("highlight-next-line")?n.add(a.length+1):(a.push(e),t&&n.add(a.length-1))})),{displayCode:h(a.join("\n")),highlightLines:n}}),[f]),v=(0,a.useMemo)((()=>function(e,n){return["bash","zsh","shell","sh"].includes(n)?"string"!=typeof e?"":e.split("\n").map((e=>e.replace(/^\s*\$\s+/,"").replace(/^\s*\$/,""))).join("\n"):e}(b,y)),[b,y]),j="no"===y?"text":y,w=(0,a.useMemo)((()=>l||(o&&""!==o.trim()?o:"bash"===y?"Terminal":"text"===y||""===y?"text":j)),[l,o,y,j]),C=(0,a.useRef)(null),H=(0,a.useCallback)((async e=>{try{return await navigator.clipboard.writeText(e),Promise.resolve()}catch(n){const t=document.createElement("textarea");return t.value=e,t.style.position="fixed",t.style.left="-999999px",t.style.top="-999999px",document.body.appendChild(t),t.focus(),t.select(),new Promise(((e,a)=>{const s=document.execCommand("copy");t.remove(),s?e():a(n)}))}}),[]);return(0,a.useEffect)((()=>{if(!C.current)return;const e=C.current.querySelector("pre");if(!e)return;const n=setTimeout((()=>{const n=e.querySelector("code");if(!n)return;if(0===Array.from(n.children).length){const e=(n.textContent||"").split("\n");n.innerHTML="",e.forEach((e=>{const t=document.createElement("span");t.textContent=e,t.style.display="block",n.appendChild(t)}))}const t=Array.from(n.children),a=new Set;t.forEach(((e,n)=>{(d?x.has(n):k.has(n))&&a.add(n)}));const s=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),r=s?56:48,i=s?12:20;t.forEach((e=>{e.style.width="auto",e.style.display="inline-block",e.style.padding="0"}));let l=0;t.forEach((e=>{if(e){e.offsetHeight;const n=e.getBoundingClientRect(),t=Math.max(e.scrollWidth,n.width,e.offsetWidth);t>l&&(l=t)}}));const o=l+r+i;t.forEach(((e,n)=>{const t=a.has(n);if(!t&&d?(e.style.color="rgb(107, 114, 128)",e.style.fontFamily="monospace",e.querySelectorAll("*").forEach((e=>{e.style.color="inherit"}))):t&&(e.style.color="",e.style.fontFamily="",e.querySelectorAll("*").forEach((e=>{e.style.color=""}))),t){const t=a.has(n-1),r=a.has(n+1),i="dark"===document.documentElement.getAttribute("data-theme");e.style.backgroundColor=i?"rgba(59, 130, 246, 0.15)":"rgb(235, 244, 255)",e.style.display="block",e.style.position="relative";let l="0",c="0";t||(l="2px"),r||(c="2px");const d=s?"56px":"48px",u=s?"12px":"20px",h=s?"0":"-20px";e.style.margin=`${l} ${h} ${c} ${h}`,e.style.padding=`4px ${d} 4px ${u}`,e.style.boxSizing="border-box",e.style.display="block",e.style.width=o>0?`${o}px`:"fit-content",e.style.minWidth=s?"100%":"calc(100% + 40px)",e.style.borderRadius="0",e.style.minHeight=s?"40px":"32px",e.style.lineHeight="1.7";const p=e.querySelector(".line-copy-button");p&&p.remove();const g=document.createElement("button");g.className="line-copy-button";const y=s?"18":"16";g.innerHTML=`\n                        <svg width="${y}" height="${y}" viewBox="0 0 16 16" fill="currentColor" style="display: block;">\n                            <path fill-rule="evenodd" clip-rule="evenodd" d="M2.75 0.5C1.7835 0.5 1 1.2835 1 2.25V9.75C1 10.7165 1.7835 11.5 2.75 11.5H3.75H4.5V10H3.75H2.75C2.61193 10 2.5 9.88807 2.5 9.75V2.25C2.5 2.11193 2.61193 2 2.75 2H8.25C8.38807 2 8.5 2.11193 8.5 2.25V3H10V2.25C10 1.2835 9.2165 0.5 8.25 0.5H2.75ZM7.75 4.5C6.7835 4.5 6 5.2835 6 6.25V13.75C6 14.7165 6.7835 15.5 7.75 15.5H13.25C14.2165 15.5 15 14.7165 15 13.75V6.25C15 5.2835 14.2165 4.5 13.25 4.5H7.75ZM7.5 6.25C7.5 6.11193 7.61193 6 7.75 6H13.25C13.3881 6 13.5 6.11193 13.5 6.25V13.75C13.5 13.8881 13.3881 14 13.25 14H7.75C7.61193 14 7.5 13.8881 7.5 13.75V6.25Z"/>\n                        </svg>\n                    `;const m=s?"36px":"28px",x="8px",f=s?"6px":"4px";g.style.cssText=`\n                        position: absolute;\n                        right: ${x};\n                        top: 50%;\n                        transform: translateY(-50%);\n                        background: ${i?"rgba(38, 38, 38, 0.95)":"rgba(255, 255, 255, 0.95)"};\n                        border: 1px solid ${i?"rgba(82, 82, 82, 0.8)":"rgba(203, 213, 225, 0.8)"};\n                        outline: none;\n                        cursor: pointer;\n                        padding: ${f};\n                        border-radius: ${s?"8px":"6px"};\n                        color: rgb(107, 114, 128);\n                        opacity: ${s?"0.85":"0"};\n                        transition: all 0.2s ease;\n                        display: flex;\n                        align-items: center;\n                        justify-content: center;\n                        z-index: 10;\n                        pointer-events: auto;\n                        user-select: none;\n                        -webkit-user-select: none;\n                        -webkit-tap-highlight-color: transparent;\n                        touch-action: manipulation;\n                        width: ${m};\n                        height: ${m};\n                        min-width: ${m};\n                        min-height: ${m};\n                        flex-shrink: 0;\n                        box-shadow: ${i?"0 2px 6px rgba(0, 0, 0, 0.5)":"0 2px 6px rgba(0, 0, 0, 0.2)"};\n                    `;let b=!1;const k=async n=>{if(n.preventDefault(),n.stopPropagation(),b)return;b=!0;const t=e.cloneNode(!0),a=t.querySelector(".line-copy-button");a&&a.remove();let s=t.textContent||"";const r=s.indexOf("$");-1!==r&&(s=s.substring(r+1)),s=s.trim(),H(s).then((()=>{g.innerHTML=`\n                                <svg width="${y}" height="${y}" viewBox="0 0 16 16" fill="currentColor" style="display: block;">\n                                    <path fill-rule="evenodd" clip-rule="evenodd" d="M15.5607 3.99999L15.0303 4.53032L6.23744 13.3232C5.55403 14.0066 4.44599 14.0066 3.76257 13.3232L4.2929 12.7929L3.76257 13.3232L0.969676 10.5303L0.439346 9.99999L1.50001 8.93933L2.03034 9.46966L4.82323 12.2626C4.92086 12.3602 5.07915 12.3602 5.17678 12.2626L13.9697 3.46966L14.5 2.93933L15.5607 3.99999Z"/>\n                                </svg>\n                            `,g.style.color="rgb(34, 197, 94)",setTimeout((()=>{g.innerHTML=`\n                                    <svg width="${y}" height="${y}" viewBox="0 0 16 16" fill="currentColor" style="display: block;">\n                                        <path fill-rule="evenodd" clip-rule="evenodd" d="M2.75 0.5C1.7835 0.5 1 1.2835 1 2.25V9.75C1 10.7165 1.7835 11.5 2.75 11.5H3.75H4.5V10H3.75H2.75C2.61193 10 2.5 9.88807 2.5 9.75V2.25C2.5 2.11193 2.61193 2 2.75 2H8.25C8.38807 2 8.5 2.11193 8.5 2.25V3H10V2.25C10 1.2835 9.2165 0.5 8.25 0.5H2.75ZM7.75 4.5C6.7835 4.5 6 5.2835 6 6.25V13.75C6 14.7165 6.7835 15.5 7.75 15.5H13.25C14.2165 15.5 15 14.7165 15 13.75V6.25C15 5.2835 14.2165 4.5 13.25 4.5H7.75ZM7.5 6.25C7.5 6.11193 7.61193 6 7.75 6H13.25C13.3881 6 13.5 6.11193 13.5 6.25V13.75C13.5 13.8881 13.3881 14 13.25 14H7.75C7.61193 14 7.5 13.8881 7.5 13.75V6.25Z"/>\n                                    </svg>\n                                `,g.style.color="rgb(107, 114, 128)",b=!1}),1500)})).catch((e=>{console.error("Copy failed:",e),b=!1}))},v=()=>{s||(g.style.opacity="1")},j=()=>{s||(g.style.opacity="0")},w=()=>{s||(g.style.backgroundColor=i?"rgba(82, 82, 82, 0.9)":"rgba(229, 229, 229, 0.8)",g.style.opacity="1",g.style.transform="translateY(-50%) scale(1.05)")},C=()=>{s||(g.style.backgroundColor=i?"rgba(38, 38, 38, 0.95)":"rgba(255, 255, 255, 0.95)",g.style.transform="translateY(-50%) scale(1)",g.style.opacity="0")},L=e=>{s&&(g.style.backgroundColor=i?"rgba(82, 82, 82, 1)":"rgba(200, 200, 200, 1)",g.style.transform="translateY(-50%) scale(0.92)",g.style.opacity="1")},$=e=>{s&&setTimeout((()=>{g.style.backgroundColor=i?"rgba(38, 38, 38, 0.95)":"rgba(255, 255, 255, 0.95)",g.style.transform="translateY(-50%) scale(1)",g.style.opacity="0.85"}),100)};s?(g.addEventListener("touchstart",L,{passive:!0}),g.addEventListener("touchend",$,{passive:!0}),g.addEventListener("click",k)):(e.addEventListener("mouseenter",v),e.addEventListener("mouseleave",j),g.addEventListener("mouseenter",w),g.addEventListener("mouseleave",C),g.addEventListener("click",k)),e.appendChild(g)}else{const n=e.querySelector(".line-copy-button");n&&n.remove()}}))}),100);return()=>{clearTimeout(n)}}),[k,b,w,d,x]),(0,r.jsxs)("div",{ref:C,className:"rounded-xl font-mono my-6 overflow-hidden text-sm  bg-neutral-50 border border-neutral-200 shadow-sm  dark:bg-neutral-900 dark:border-neutral-800 dark:shadow-black/30",onMouseEnter:()=>g(!0),onMouseLeave:()=>g(!1),children:[(0,r.jsx)(u,{title:w,code:v,isHovered:p,copiable:c,langs:i,currentLang:y,onLangChange:m}),(0,r.jsx)("div",{className:"bg-white dark:bg-neutral-900 overflow-x-auto",children:(0,r.jsx)(s.A,{language:j,customStyle:{margin:0,padding:"20px",fontSize:"0.875rem",lineHeight:"1.7",fontWeight:400,backgroundColor:"transparent"},wrapLines:!0,wrapLongLines:!1,children:b})})]})}},28453:(e,n,t)=>{t.d(n,{R:()=>i,x:()=>l});var a=t(96540);const s={},r=a.createContext(s);function i(e){const n=a.useContext(r);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:i(e.components),a.createElement(r.Provider,{value:n},e.children)}}}]);