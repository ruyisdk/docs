"use strict";(self.webpackChunkruyisdk=self.webpackChunkruyisdk||[]).push([[4183],{4222:(e,t,n)=>{n.r(t),n.d(t,{default:()=>k});var r=n(6540),o=n(394),s=n(9529),l=n(6952),i=n(2431),a=n(4616),d=n(4773),c=n(2001),u=n(4335),h=n(4586);const m=()=>{const{siteConfig:{customFields:e}}=(0,h.A)();return(0,r.useMemo)((()=>{if(!e.apiURL)return null;return u.A.create({baseURL:`https://${e.apiURL}`,timeout:1e4,headers:{"Content-Type":"application/json"}})}),[e.apiURL])};var f=n(1312);const p="container_yIVw",y="card_mEnl";var w=n(3472),x=n(4848);const g=()=>(0,x.jsxs)("div",{style:{textAlign:"center",height:"20rem"},children:[(0,x.jsx)(d.A,{style:{fontSize:"2rem",color:"black",marginTop:"1rem"}}),(0,x.jsx)("p",{style:{color:"black"},children:(0,f.T)({id:"\u6682\u65e0\u6570\u636e",message:"\u6682\u65e0\u6570\u636e"})})]}),v=e=>{let{data:t}=e;const n=(0,r.useRef)(),o=(0,r.useRef)(),s=(0,r.useMemo)((()=>Object.entries(t).map((e=>{let[t,{total:n}]=e;return{action:t,total:n}}))),[t]);return(0,r.useEffect)((()=>{if(s.length&&n.current){o.current&&o.current.destroy();const e=new w.t1({container:n.current,autoFit:!0,events:{enabled:!1}});o.current=e,e.coordinate({transform:[{type:"transpose"}]}),e.interval().style({fill:"#0d4977"}).data(s).transform({type:"sortX",reverse:!0,by:"y"}).axis("x",{line:!1,title:!1,label:!1,tick:!1}).axis("y",{title:!1,line:!1,tick:!1}).encode("x","action").encode("y","total").scale("x",{padding:.6}).style("maxWidth",200).label({text:"action",position:"top-left",fill:"#000",dy:-22,fontWeight:600}).label({text:"total",position:"left",fill:"white",dx:5,fontWeight:600}).interaction({tooltip:{body:!1}}),e.interaction("view-scroll",!1),e.render()}}),[s]),(0,x.jsxs)("div",{className:"custom-scroll",style:{height:"75vh",overflow:"auto",WebkitOverflowScrolling:"touch",overscrollBehavior:"contain",msOverflowStyle:"none",scrollbarWidth:"none"},children:[(0,x.jsx)("style",{jsx:!0,children:"\n        .custom-scroll::-webkit-scrollbar {\n          display: none;\n        }\n      "}),s.length?(0,x.jsx)("div",{ref:n,style:{width:"100%",height:"70vh",touchAction:"pan-y",position:"relative"},children:(0,x.jsx)("div",{style:{position:"absolute",top:0,left:0,right:0,bottom:0,zIndex:0,background:"transparent"}})}):(0,x.jsx)("div",{style:{width:"100%",height:"70vh"},children:(0,x.jsx)(g,{})})]})},b=()=>{const e=m(),[t,n]=(0,r.useState)(null),[o,d]=(0,r.useState)(null),u=(0,r.useRef)(),h=(0,r.useRef)(null),[w,b]=(0,r.useState)(!0),[j,k]=(0,r.useState)(0),[T,S]=(0,r.useState)(!1),A=(0,r.useRef)(null),[E,_]=(0,r.useState)(!1);(0,r.useEffect)((()=>{const e=()=>{_(window.matchMedia("(max-width: 1024px)").matches)};return e(),window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}}),[]),(0,r.useEffect)((()=>{const e=()=>{if(u.current){const e=u.current.scrollTop,t=window.innerHeight,n=Math.round(e/t);k(n)}},t=u.current;return t&&t.addEventListener("scroll",e),()=>{t&&t.removeEventListener("scroll",e)}}),[]),(0,r.useEffect)((()=>{if("undefined"==typeof IntersectionObserver)return;const e=document.querySelector("footer");if(e){h.current=e;const t=new IntersectionObserver((e=>{e.forEach((e=>{b(e.isIntersecting)}))}),{threshold:[0]});return t.observe(e),()=>{t.disconnect()}}}),[]);const D=e=>{!u.current||T||w||(S(!0),u.current.scrollTo({top:e*window.innerHeight,behavior:"smooth"}),A.current&&clearTimeout(A.current),A.current=setTimeout((()=>{S(!1)}),500))},R=e=>{if(!T&&!w&&E)if("ArrowDown"===e.key||"PageDown"===e.key){e.preventDefault();const t=Math.min(2,j+1);D(t)}else if("ArrowUp"===e.key||"PageUp"===e.key){e.preventDefault();const t=Math.max(0,j-1);D(t)}};(0,r.useEffect)((()=>(window.addEventListener("keydown",R),()=>{window.removeEventListener("keydown",R),A.current&&clearTimeout(A.current)})),[T,j,w,E]);const C=()=>E?(0,x.jsx)("div",{style:{position:"fixed",right:"20px",top:"50%",transform:"translateY(-50%)",display:"flex",flexDirection:"column",gap:"10px",zIndex:100},children:[0,1,2].map((e=>(0,x.jsx)("div",{onClick:()=>D(e),style:{width:"12px",height:"12px",borderRadius:"50%",border:"none",background:j===e?"#ffffff":"rgba(255,255,255,0.5)",transition:"background 0.3s ease",cursor:w?"default":"pointer"}},e)))}):null,I=[{key:"1",label:(0,f.T)({id:"\u6700\u5e38\u7528\u6307\u4ee4 Top Commands",message:"\u6700\u5e38\u7528\u6307\u4ee4"}),children:(0,x.jsx)(v,{data:t?.top_commands||{}})},{key:"2",label:(0,f.T)({id:"\u5206\u76ee\u5f55\u7684\u4e0b\u8f7d\u6570\u91cf",message:"\u5206\u76ee\u5f55\u7684\u4e0b\u8f7d\u6570\u91cf"}),children:(0,x.jsx)(v,{data:(e=>{if(!e)return{};const t={downloads:"\u7ec4\u4ef6\u4e0b\u8f7d\u91cf",pm_downloads:"\u5305\u7ba1\u7406\u5668\u4e0b\u8f7d\u91cf","3rdparty":"\u7b2c\u4e09\u65b9\u4e0b\u8f7d\u91cf",humans:"\u6587\u6863\u7b49",ide:"IDE\u4e0b\u8f7d\u6b21\u6570"},n={};return Object.entries(e.other_categories_downloads||{}).forEach((e=>{let[r,o]=e;n[t[r]]={...o}})),e.downloads&&(n[t.downloads]={...e.downloads}),e.pm_downloads&&(n[t.pm_downloads]={...e.pm_downloads}),n})(t)})}],z=[{key:"1",label:(0,f.T)({id:"\u6700\u5e38\u7528\u5305 Top Packages",message:"\u6700\u5e38\u7528\u5305"}),children:(0,x.jsx)(v,{data:t?.top_packages||{}})}];return(0,r.useEffect)((()=>{if(!e)return;let t=null,r=0;const s=async()=>{if(r>5)console.warn("Stop retry");else try{n((await e.post("/fe/dashboard",{})).data),d(null)}catch(o){console.error("Statistical Data API error, will retry",o),d(o),t=setTimeout(s,2**r*1e3),r++}};if("requestIdleCallback"in window){const e=requestIdleCallback(s);return()=>{cancelIdleCallback(e),clearTimeout(t)}}return t=setTimeout(s,500),()=>clearTimeout(t)}),[e]),(0,x.jsxs)("div",{ref:u,className:p,style:{pointerEvents:w&&E?"none":"auto"},children:[(0,x.jsx)(C,{}),(0,x.jsxs)(s.Ay,{renderEmpty:g,theme:{components:{Tabs:{itemSelectedColor:"#0d4977",inkBarColor:"#0d4977"}}},children:[(0,x.jsx)("div",{className:`${y}`,children:(0,x.jsxs)(l.A,{style:{width:"90%",height:"90vh",backgroundColor:"rgba(0,0,0,0)",border:"none",margin:"0 auto"},children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("h1",{style:{color:"#e3e3e3",marginTop:"2rem"},children:(0,f.T)({id:"RuyiSDK \u6570\u636e\u603b\u89c8",message:"RuyiSDK \u6570\u636e\u603b\u89c8"})}),(0,x.jsx)(i.A,{title:(0,x.jsx)("span",{style:{color:"#e3e3e3",fontSize:"1.5rem",fontWeight:"bold"},children:(0,f.T)({id:"\u4e0b\u8f7d\u6570\u91cf Downloads",message:"\u7ec4\u4ef6\u4e0b\u8f7d\u6570\u91cf"})}),value:null!=t?.downloads?.total&&null!=t?.pm_downloads?.total?t.downloads.total+t.pm_downloads.total:(0,f.T)({id:"\u8f7d\u5165\u4e2d",message:"\u8f7d\u5165\u4e2d"})+"...",valueStyle:{color:"#e3e3e3",fontSize:null!=t?.downloads?.total?"3rem":"1.5rem"},style:{marginTop:"2rem"}}),(0,x.jsx)(i.A,{title:(0,x.jsx)("span",{style:{color:"#e3e3e3",fontSize:"1.5rem",fontWeight:"bold"},children:(0,f.T)({id:"\u5b89\u88c5\u53f0\u6570 Installs",message:"\u5305\u7ba1\u7406\u5668\u5b89\u88c5\u53f0\u6570"})}),value:t?.installs?.total||(0,f.T)({id:"\u8f7d\u5165\u4e2d",message:"\u8f7d\u5165\u4e2d"})+"...",headStyle:{color:"#e3e3e3"},valueStyle:{color:"#e3e3e3",fontSize:null!=t?.downloads?.total?"3rem":"1.5rem"}})]}),t&&(0,x.jsxs)("p",{style:{marginTop:"4rem",color:"#d1d1d1",fontSize:"0.8rem"},children:[(0,f.T)({id:"\u6700\u540e\u66f4\u65b0\u65f6\u95f4",message:"\u6570\u636e\u66f4\u65b0\u65f6\u95f4"}),":",String(t.last_updated).slice(0,16).replace("T"," ")]})]})}),(0,x.jsx)("div",{className:`${y}`,children:(0,x.jsx)(l.A,{style:{width:"80%",height:"75vh",border:"none",marginTop:"1rem"},children:(0,x.jsx)(a.A,{defaultActiveKey:"1",items:I,style:{width:"100%",height:"90vh"},more:{icon:(0,x.jsx)(c.A,{}),trigger:"click"}})})}),(0,x.jsx)("div",{className:`${y}`,children:(0,x.jsx)(l.A,{style:{width:"80%",height:"75vh",border:"none",marginTop:"1rem"},children:(0,x.jsx)(a.A,{defaultActiveKey:"1",items:z,style:{width:"100%",height:"90vh"},more:{icon:(0,x.jsx)(c.A,{}),trigger:"click"}})})})]})]})},j="container_qKy1",k=()=>(0,x.jsx)(o.A,{title:"Data Panel",description:"RuyiSDK Data Panel",children:(0,x.jsx)("div",{className:j,children:(0,x.jsx)(b,{})})})}}]);